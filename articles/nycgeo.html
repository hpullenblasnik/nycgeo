<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to nycgeo • nycgeo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to nycgeo">
<meta property="og:description" content="">
<meta property="og:image" content="https://nycgeo.mattherman.info/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-112317483-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-112317483-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nycgeo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nycgeo.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mfherman/nycgeo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to nycgeo</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mfherman/nycgeo/blob/master/vignettes/nycgeo.Rmd"><code>vignettes/nycgeo.Rmd</code></a></small>
      <div class="hidden name"><code>nycgeo.Rmd</code></div>

    </div>

    
    
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h2>
<p>The most basic usage of <code>nycgeo</code> is to get boundaries in the <code>sf</code> format. Use <code><a href="../reference/nyc_boundaries.html">nyc_boundaries()</a></code> to get your desired geography. To make best use of the package, you should also load the <code>sf</code> package when using <code>nycgeo</code>. For these examples, I’ll also load <code>tidyverse</code> as this will allow us to take advantage of pretty <code>tibble</code> printing and will come in handy when we want to manipulate and map the spatial data later.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nycgeo)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="../reference/nyc_boundaries.html">nyc_boundaries</a></span>(<span class="dt">geography =</span> <span class="st">"tract"</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Simple feature collection with 2166 features and 12 fields</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; geometry type:  MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; dimension:      XY</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; bbox:           xmin: 913180.2 ymin: 120131.4 xmax: 1067382 ymax: 272798.5</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; epsg (SRID):    2263</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; proj4string:    +proj=lcc +lat_1=41.03333333333333 +lat_2=40.66666666666666 +lat_0=40.16666666666666 +lon_0=-74 +x_0=300000.0000000001 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=us-ft +no_defs</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; # A tibble: 2,166 x 13</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;    geoid borough_tract_id state_fips county_fips tract_id county_name</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;  1 3606… 1000100          36         061         000100   New York   </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt;  2 3606… 1000201          36         061         000201   New York   </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;  3 3606… 1000202          36         061         000202   New York   </span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;  4 3606… 1000500          36         061         000500   New York   </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;  5 3606… 1000600          36         061         000600   New York   </span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;  6 3606… 1000700          36         061         000700   New York   </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;  7 3606… 1000800          36         061         000800   New York   </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;  8 3606… 1000900          36         061         000900   New York   </span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;  9 3606… 1001001          36         061         001001   New York   </span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; 10 3606… 1001002          36         061         001002   New York   </span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; # … with 2,156 more rows, and 7 more variables: borough_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; #   borough_id &lt;chr&gt;, nta_id &lt;chr&gt;, nta_name &lt;chr&gt;, puma_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; #   puma_name &lt;chr&gt;, geometry &lt;MULTIPOLYGON [US_survey_foot]&gt;</span></a></code></pre></div>
</div>
<div id="filter-by-geography" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-by-geography" class="anchor"></a>Filter by geography</h2>
<p>If you don’t need census tracts for the entire city, you can use the <code>filter_by</code> and <code>region</code> arguments of <code><a href="../reference/nyc_boundaries.html">nyc_boundaries()</a></code> to specify the area you are interested in. For example, the following code returns only census tracts in Brooklyn and Queens.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">bk_qn_tracts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nyc_boundaries.html">nyc_boundaries</a></span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dt">geography =</span> <span class="st">"tract"</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">filter_by =</span> <span class="st">"borough"</span>,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">region =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"brooklyn"</span>, <span class="st">"queens"</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">ggplot</span>(bk_qn_tracts) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="nycgeo_files/figure-html/filter-by-1.png" width="100%"></p>
<p>Note, you can select multiple regions by passing a character vector to the <code>region</code> argument, but you can only choose a single geography to <code>filter_by</code>. Additionally, you can only filter by a geography that is <em>larger than or equal to</em> the boundaries you request. For example, it is not possible to filter PUMAs by NTAs because NTAs are smaller than PUMAs.</p>
</div>
<div id="adding-american-community-survey-data" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-american-community-survey-data" class="anchor"></a>Adding American Community Survey Data</h2>
<p><code>nycgeo</code> includes selected estimates from the American Community Survey as datasets. You can access these datasets directly or have them appended to the spatial data. To print a <code>tibble</code> of ACS data, simply call the data you want.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">nta_acs_data</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; # A tibble: 189 x 27</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;    nta_id pop_total_est pop_total_moe pop_white_est pop_white_moe</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  1 BK09           24212          891.         17734          859.</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  2 BK17           67681         1736.         43146         1449.</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  3 BK19           35811         1388.         24817         1139.</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  4 BK21           31132         1268.          9804          894.</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  5 BK23           16436          707.         15380          698.</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  6 BK25           45031         1498.         33709         1346.</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  7 BK26           30828         1480.         14676          961.</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  8 BK27           32808         1293.         14483          863.</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  9 BK28           93114         2087.         38709         1559.</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; 10 BK29           66055         1757.         29318         1293.</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; # … with 179 more rows, and 22 more variables: pop_white_pct_est &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; #   pop_white_pct_moe &lt;dbl&gt;, pop_black_est &lt;dbl&gt;, pop_black_moe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; #   pop_black_pct_est &lt;dbl&gt;, pop_black_pct_moe &lt;dbl&gt;, pop_hisp_est &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; #   pop_hisp_moe &lt;dbl&gt;, pop_hisp_pct_est &lt;dbl&gt;, pop_hisp_pct_moe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; #   pop_asian_est &lt;dbl&gt;, pop_asian_moe &lt;dbl&gt;, pop_asian_pct_est &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; #   pop_asian_pct_moe &lt;dbl&gt;, pop_ba_above_est &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; #   pop_ba_above_moe &lt;dbl&gt;, pop_ba_above_pct_est &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; #   pop_ba_above_pct_moe &lt;dbl&gt;, pop_inpov_est &lt;dbl&gt;, pop_inpov_moe &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; #   pop_inpov_pct_est &lt;dbl&gt;, pop_inpov_pct_moe &lt;dbl&gt;</span></a></code></pre></div>
<p>To add census estimates to an <code>sf</code> object, use <code>add_acs_data = TRUE</code> to an <code><a href="../reference/nyc_boundaries.html">nyc_boundaries()</a></code>call. For example, here we get all NTAs in Manhattan with ACS data appended. One convenience of having the ACS data joined to the <code>sf</code> object is that you can very simply make a choropleth map. Here we do it with <code>ggplot2</code>, but you could use <a href="https://github.com/mtennekes/tmap"><code>tmap</code></a>, <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a> or any other spatial package that works with <code>sf</code> objects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mn_ntas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nyc_boundaries.html">nyc_boundaries</a></span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="dt">geography =</span> <span class="st">"nta"</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="dt">filter_by =</span> <span class="st">"borough"</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="dt">region =</span> <span class="st">"manhattan"</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dt">add_acs_data =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">ggplot</span>(mn_ntas) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> pop_ba_above_pct_est)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">    <span class="dt">name =</span> <span class="st">"Bachelor's or above"</span>,</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/scales/topics/number_format">percent_format</a></span>(),</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    <span class="dt">option =</span> <span class="st">"magma"</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">"transparent"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Which neighborhoods in Manhattan are most educated?"</span>)</a></code></pre></div>
<p><img src="nycgeo_files/figure-html/add-acs-data-1.png" width="100%"></p>
</div>
<div id="joining-with-other-data" class="section level2">
<h2 class="hasAnchor">
<a href="#joining-with-other-data" class="anchor"></a>Joining with other data</h2>
<p>One use case of <code><a href="../reference/nycgeo-package.html">nycgeo()</a></code> is if you have non-spatial data that relates to census tracts, NTAs, or other geographies and need to join that data with spatial boundaries to plot or otherwise analyze. This non-spatial data may be coded in a variety of ways and might not have names or IDs that match your spatial data. The <code>sf</code> data provided in <code>nycgeo</code> seeks to have a variety of geographic metadata that will match whatever labels your non-spatial data has.</p>
<p>In this example, we have non-spatial data from the <a href="https://www1.nyc.gov/site/doh/health/neighborhood-health/nyc-neighborhood-health-atlas.page">NYC Neighborhood Health Atlas</a> at the NTA-level from which we would like to make a choropleth map. To do this, we import the .csv file and then join it to the spatial NTA object matching on NTA IDs. Then, we can map it as in the above example.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">nta_health &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/mfherman/nycgeo/master/inst/extdata/nta-health.csv"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(NTA_Code, BlackCarbon)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/nyc_boundaries.html">nyc_boundaries</a></span>(<span class="dt">geography =</span> <span class="st">"nta"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw">left_join</span>(nta_health, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"nta_id"</span> =<span class="st"> "NTA_Code"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> BlackCarbon)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">name =</span> <span class="st">"Black carbon (absorbance units)"</span>, <span class="dt">option =</span> <span class="st">"inferno"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">"transparent"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Which neighborhoods have high levels of black carbon pollution?"</span>)</a></code></pre></div>
<p><img src="nycgeo_files/figure-html/join-health-1.png" width="100%"></p>
</div>
<div id="finding-which-districts-a-set-of-points-lies-within" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-which-districts-a-set-of-points-lies-within" class="anchor"></a>Finding which districts a set of points lies within</h2>
<p><a href="https://en.wikipedia.org/wiki/Point_in_polygon">Point-in-polygon operations</a> are common tasks for spatial analysis. Given a set of points we want to find out which polygon contains each point. A real-world application of this would be counting the number of schools in each community district.</p>
<p>We start with a (non-spatial) data frame of all schools in New York, but with columns for latitude and longitude. Then we use those latitudes and longitudes to convert the data frame to an sf object. From there, we can use the <code><a href="../reference/nyc_point_poly.html">nyc_point_poly()</a></code> function to find which community district (CD) each point (school) is in and then count by CD to get the total number of schools in each CD.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">nyc_schools &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/mfherman/nycgeo/master/inst/extdata/nyc-schools.csv"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">schools_sf &lt;-<span class="st"> </span>nyc_schools <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_as_sf">st_as_sf</a></span>(</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">    <span class="dt">coords =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">    <span class="dt">crs =</span> <span class="dv">4326</span>,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="../reference/nyc_point_poly.html">nyc_point_poly</a></span>(schools_sf, <span class="st">"cd"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_geometry">st_set_geometry</a></span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span><span class="kw">count</span>(cd_name, borough_cd_id)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; # A tibble: 60 x 3</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;    cd_name                     borough_cd_id     n</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;    &lt;chr&gt;                       &lt;chr&gt;         &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;  1 Bronx Community District 1  201              69</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  2 Bronx Community District 10 210              32</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;  3 Bronx Community District 11 211              41</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;  4 Bronx Community District 12 212              36</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;  5 Bronx Community District 2  202              29</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;  6 Bronx Community District 3  203              72</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt;  7 Bronx Community District 4  204              67</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt;  8 Bronx Community District 5  205              43</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt;  9 Bronx Community District 6  206              55</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; 10 Bronx Community District 7  207              34</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; # … with 50 more rows</span></a></code></pre></div>
</div>
<div id="available-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#available-datasets" class="anchor"></a>Available datasets</h2>
<table class="table">
<colgroup>
<col width="13%">
<col width="20%">
<col width="25%">
<col width="30%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th>Geography</th>
<th>Definition</th>
<th>Spatial data</th>
<th>Census data</th>
<th>Filter by</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"borough"</code></td>
<td>borough (county)</td>
<td><code><a href="../reference/borough_sf.html">nycgeo::borough_sf</a></code></td>
<td><code><a href="../reference/borough_acs_data.html">nycgeo::borough_acs_data</a></code></td>
<td><code>"borough"</code></td>
</tr>
<tr class="even">
<td><code>"puma"</code></td>
<td>public use microdata area</td>
<td><code><a href="../reference/puma_sf.html">nycgeo::puma_sf</a></code></td>
<td><code><a href="../reference/puma_acs_data.html">nycgeo::puma_acs_data</a></code></td>
<td>
<code>"borough"</code>,<code>"puma"</code>
</td>
</tr>
<tr class="odd">
<td><code>"cd"</code></td>
<td>community district</td>
<td><code><a href="../reference/cd_sf.html">nycgeo::cd_sf</a></code></td>
<td>not currently available</td>
<td>
<code>"borough"</code>, <code>"cd"</code>
</td>
</tr>
<tr class="even">
<td><code>"nta"</code></td>
<td>neighborhood tabulation area</td>
<td><code><a href="../reference/nta_sf.html">nycgeo::nta_sf</a></code></td>
<td><code><a href="../reference/nta_acs_data.html">nycgeo::nta_acs_data</a></code></td>
<td>
<code>"borough"</code>,<code>"puma"</code>, <code>"nta"</code>
</td>
</tr>
<tr class="odd">
<td><code>"tract"</code></td>
<td>census tract</td>
<td><code><a href="../reference/tract_sf.html">nycgeo::tract_sf</a></code></td>
<td><code><a href="../reference/tract_acs_data.html">nycgeo::tract_acs_data</a></code></td>
<td>
<code>"borough"</code>,<code>"puma"</code>, <code>"nta"</code>
</td>
</tr>
<tr class="even">
<td><code>"block"</code></td>
<td>census block</td>
<td><code><a href="../reference/block_sf.html">nycgeo::block_sf</a></code></td>
<td><code><a href="../reference/block_census_data.html">nycgeo::block_census_data</a></code></td>
<td>
<code>"borough"</code>,<code>"puma"</code>, <code>"nta"</code>
</td>
</tr>
<tr class="odd">
<td><code>"council"</code></td>
<td>city council district</td>
<td><code><a href="../reference/council_sf.html">nycgeo::council_sf</a></code></td>
<td>not currently available</td>
<td>none</td>
</tr>
<tr class="even">
<td><code>"police"</code></td>
<td>police precinct</td>
<td><code><a href="../reference/police_sf.html">nycgeo::police_sf</a></code></td>
<td>not currently available</td>
<td>none</td>
</tr>
<tr class="odd">
<td><code>"school"</code></td>
<td>school district</td>
<td><code><a href="../reference/school_sf.html">nycgeo::school_sf</a></code></td>
<td>not currently available</td>
<td>none</td>
</tr>
<tr class="even">
<td><code>"cong"</code></td>
<td>u.s. congressional district</td>
<td><code><a href="../reference/cong_sf.html">nycgeo::cong_sf</a></code></td>
<td>not currently available</td>
<td>none</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-usage">Basic Usage</a></li>
      <li><a href="#filter-by-geography">Filter by geography</a></li>
      <li><a href="#adding-american-community-survey-data">Adding American Community Survey Data</a></li>
      <li><a href="#joining-with-other-data">Joining with other data</a></li>
      <li><a href="#finding-which-districts-a-set-of-points-lies-within">Finding which districts a set of points lies within</a></li>
      <li><a href="#available-datasets">Available datasets</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://mattherman.info">Matt Herman</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
